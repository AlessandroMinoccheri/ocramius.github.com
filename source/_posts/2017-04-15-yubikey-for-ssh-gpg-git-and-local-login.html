---
layout: post
title: YubiKey for SSH, Login, 2FA, GPG and Git Signing
category: Security
tags: ["YubiKey", "GPG", "SSH", "security", "GPG", "2FA", "GIT", "Authentication"]
year: 2017
month: 1
day: 25
published: true
summary: Using a single YubiKey for Two-Factor Auth, SSH login, GPG signing (GIT too) and to log into your computer
description: A little walk-through in how to effectively use a YubiKey for everyday security: GPG, SSH, Login, 2FA
tweet:
---

<p>
    I've been using a
    <a href="https://www.yubico.com/products/yubikey-hardware/yubikey-neo/" target="_blank">
        YubiKey Neo
    </a>
    for a bit over two years now, but its usage was limited to
    <abbr title="Two Factor Authentication">2FA</abbr>
    and
    <abbr title="Universal Two Factor Authentication">U2F</abbr>.
</p>

<p>
    Last week, I received my new DELL XPS 15 9560, and since I am maintaining
    some high impact open source projects, I wanted the setup to be well secured.
</p>

<p>
    In addition to that, I caught a bad flu, and that gave me enough excuses
    to waste time in figuring things out.
</p>

<p>
    In this article, I'm going to describe what I did, and how you can reproduce
    my setup for your own safety, and for the safety of people that trust what you do.
</p>

<h2>Yubi-WHAT?</h2>

<p>
    In first place, you should know that I am absolutely not a security expert:
    all I did was following the online tutorials that I found.
    I also am not a cryptography expert, and I am constantly dissatisfied with
    how the crypto community reduces everything into a
    <abbr title="Three Letter Acronym">TLA</abbr>,
    making even the simplest things impossible to understand for mere mortals.
</p>

<p>
    First, let's clarify what a YubiKey is.
</p>

<p>
    <img
        src="/img/posts/2017-04-15-yubikey-for-ssh-gpg-git-and-local-login/yoshi-yubikey.jpg"
        alt="A YubiKey Neo on a cat"
    />
</p>

<p>
    That thing is a YubiKey.
</p>

<p>
    What does it do?
</p>

<p>
    It's basically an USB key filled with crypto features.
    It also is (currently) impossible to make a physical copy of it,
    and it is not possible to extract information written to it.
</p>

<p>
    It can:
</p>

<ul>
    <li>Generate HMAC hashes (kinda)</li>
    <li>Store GPG private keys</li>
    <li>Act as a keyboard that generates time-based passwords</li>
    <li>Generate 2FA time-based login codes</li>
</ul>

<h2>What do we need?</h2>

<p>
    In order to follow this tutorial, you should have at least
    2 (two) YubiKey Neo or equivalent devices. This means that
    you will have to spend approximately USD 100: these things
    are quite expensive. You absolutely need a backup key,
    because all these security measures may lock you out of
    your systems if you lose or damage a YubiKey.
</p>

<p>
    Our kickass setup will allow us to do a series of cool
    things related to daily development operations:
</p>

<ul>
    <li>Two Factor Authentication</li>
    <li>PAM Authentication (logging into your linux/mac PC)</li>
    <li>GPG mail and GIT commit signing/encrypting</li>
    <li>SSH Authentication</li>
</ul>

<p>
    <img
        src="/img/posts/2017-04-15-yubikey-for-ssh-gpg-git-and-local-login/yubikey-features.jpg"
        alt="Covered YubiKey features"
    />
</p>

<h2>Setting up NFC 2FA</h2>

<p>
    Simple NFC-based 2FA with authentication codes will
    be useful for most readers, even non-technical ones.
</p>

<p>
    What we are doing is simply seed the YubiKey with
    Google Authenticator codes, except that we will
    use the
    <a href="https://play.google.com/store/apps/details?id=com.yubico.yubioath&hl=en" target="_blank">
        Yubico Authenticator
    </a>.
    This will only work for the "primary" key (the one
    we will likely bring with us).
</p>
